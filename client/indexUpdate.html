<div id="signDiv">   <!-- Signing in Div -->
    Username: <input id="signDiv-username" type="text"></input><br>  <!--input username box -->
    Password: <input id="signDiv-password" type="password"></input> <!--input password box -->
    <button id="signDiv-signIn">Sign In</button> <!-- Sign in button -->
    <button id="signDiv-signUp">Sign Up</button> <!-- Sign UP in button -->
</div>
<script src="/socket.io/socket.io.js"></script>
<body onload="loadSound();">

  <div id="gameDiv" style="display:none;">   <!-- Game Div, display none, until logged in! -->
      <canvas id="ctx" width="500" height="500" style="border:1px solid #000000;"> <!-- creating canvas -->
      </canvas> 

  </div>
    </body>

    <script src="/socket.io/socket.io.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <link rel="stylesheet" href="https://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.css"> <!--Mobile functionality -->
    <script src="https://code.jquery.com/jquery-1.11.3.min.js"></script>
    <script src="https://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.js"></script> <!--Mobile functionality -->
    <script src="https://code.createjs.com/soundjs-0.6.2.min.js"></script>
    <!-- <script src="scriptDraw.js"></script> -->

<script>
var socket = io(); // socket io
    var WIDTH = 500;
    var HEIGHT = 500;
    var soundID = "Shot"; //sound

    //signIn/Out
var signDiv = document.getElementById('signDiv'); //<!-- Sign in Div -->
    var signDivUsername = document.getElementById('signDiv-username'); //<!-- username element -->
    var signDivSignIn = document.getElementById('signDiv-signIn'); //<!-- sign in element -->
    var signDivPassword = document.getElementById('signDiv-password'); //<!-- password element -->
    var signDivUp = document.getElementById('signDiv-signUp'); //<!-- password element -->


    signDivSignIn.onclick = function(){  //<!-- clicking the sign in button does this function -->
        socket.emit('logIn',{username:signDivUsername.value,password:signDivPassword.value}); //<!-- emits username + password to server -->
        }

    signDivUp.onclick = function(){  //<!-- clicking the sign in button does this function -->
        socket.emit('signUp',{username:signDivUsername.value,password:signDivPassword.value}); //<!-- emits username + password to server -->
        }

    socket.on('logInResponse',function(data){  // Sign in Response function
        if(data.success){
            signDiv.style.display = 'none'; //display none until the logging has been passed
            gameDiv.style.display = 'inline-block'; //when log in has been passed then it will display the gameDiv
        }  else
            alert("Sign in was unsuccessful!"); //if password or username is wrong, you get this alart
    });

    socket.on('signPlayerRes',function(data){  // Sign UP*** in Response function
        if(data.success){
            alert("Sign up was successful!");
        }  else
            alert("Sign in was unsuccessful!"); // Not signing up
    });


    //game

function loadSound () {
    createjs.Sound.registerSound("/client/shot.mp3", soundID); //gets the sound from my client file named shot.mp3
    }

function playSound () { //play sound function
    createjs.Sound.play(soundID);
    }

var ctx = document.getElementById('ctx').getContext('2d');
  ctx.font = '30px Arial';

var Img = {}; //creats image array
    Img.bullet = new Image(); 
    Img.bullet.src = '/client/images/bullet.png'; //loads the bullet
    Img.player = new Image(); 
    Img.player.src = '/client/images/littleman.png'; //loads the player
    Img.target = new Image(); 
    Img.target.src = '/client/images/pacman.png'; //loads the target
    Img.grass = new Image(); 
    Img.grass.src = '/client/images/grasses.png'; //loads the background
       
socket.on('newPositions',function(data){
        ctx.clearRect(0,0,500,500);
        drawGrass(); //draws my map
                    
        for(var i = 0 ; i < data.player.length; i++)
            ctx.drawImage(Img.player,data.player[i].x,data.player[i].y,35,35);  //draw player   

            // ctx.drawImage(Img.target,data.enemy[i].fx,data.enemy[i].fy, 20, 20);
            
           
        for(var i = 0 ; i < data.bullet.length; i++)
            ctx.drawImage(Img.bullet,data.bullet[i].x,data.bullet[i].y,25,25); //draw bullet
            
            
            //score
            // ctx.fillStyle = 'black'; //score on black text
            // ctx.fillText("score: " + data.player[i].score,data.player[i].x,data.player[i].y); //draws the score for THAT player only!**
    });
                
var drawGrass = function(){
     // var x = WIDTH/2 - Player.list[selfId].x; //makes the character always on the middle of the map, which fixes the shots problem.
     // var y = WIDTH/2 - Player.list[selfId].y; //same as above.
     ctx.drawImage(Img.grass,1,1,500,500); //draws the grass in that area
    }
   
document.onkeydown = function(event){ //keyboard controls
        if(event.keyCode === 39) //right arrow
            socket.emit('movementKey' ,{inputId:'right',state:true});
        if(event.keyCode === 40) //down arrow
            socket.emit('movementKey' ,{inputId:'down',state:true});
        if(event.keyCode === 37) //left arrow
            socket.emit('movementKey' ,{inputId:'left',state:true});
        if(event.keyCode === 38) //up arrow
            socket.emit('movementKey' ,{inputId:'up',state:true});
        }

document.onkeyup = function(event){
        if(event.keyCode === 39) //right arrow
            socket.emit('movementKey' ,{inputId:'right',state:false});
        if(event.keyCode === 40) //down arrow
            socket.emit('movementKey' ,{inputId:'down',state:false});
        if(event.keyCode === 37) //left arrow
            socket.emit('movementKey' ,{inputId:'left',state:false});
        if(event.keyCode === 38) //up arrow
            socket.emit('movementKey' ,{inputId:'up',state:false});
        }

document.onmousedown = function(event){
    socket.emit('movementKey',{inputId:'attack',state:true}); //mouse down to attack (click)*

if(event.target.attributes["id"].value !== "ctx"){ // only plays shot sound once im logged in, had clickdown sound when pressing login!*
        return;
    } else {
        playSound(); //plays the shot sound
    }
    }

document.onmouseup = function(event){
    socket.emit('movementKey',{inputId:'attack',state:false}); //when not attacking, (unlicked)*
    }

document.onmousemove = function(event){
    var x = -250 + event.clientX - 8;  //500 being the whole screen
    var y = -250 + event.clientY - 8;
    var angle = Math.atan2(y,x) / Math.PI * 180;
    socket.emit('movementKey',{inputId:'mouseAngle',state:angle});
    }
</script>