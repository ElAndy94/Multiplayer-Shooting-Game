<div id="signDiv">   <!-- Signing in Div -->
    Username: <input id="signDiv-username" type="text"></input><br>  <!--input username box -->
    Password: <input id="signDiv-password" type="password"></input> <!--input password box -->
    <button id="signDiv-signIn">Sign In</button> <!-- Sign in button -->
</div>
<script src="/socket.io/socket.io.js"></script>
<!-- <body onload="loadSound();">

    <button onclick="playSound();" class="playSound">Play Sound</button> -->
  <div id="gameDiv" style="display:none;">   <!-- Game Div, display none, until logged in! -->
      <canvas id="ctx" width="500" height="500" style="border:1px solid #000000;">

  	</canvas> <!-- creating canvas -->
      <div id="chat-text" style="width:500px;height:100px;overflow-y:scroll"> <!-- creating chat box, with overflow which you can scroll through -->

      </div>

      <form id="chat-form">  <!-- the chat form -->
          <input id="chat-input" type="text" style="width:500px"></input>
      </form>
  </div>
<!-- </body> -->
<!-- <script type='text/javascript'src="/client/script.js"></script> -->
<script src="/socket.io/socket.io.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<link rel="stylesheet" href="https://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.css"> <!--Mobile functionality -->
<script src="https://code.jquery.com/jquery-1.11.3.min.js"></script>
<script src="https://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.js"></script> <!--Mobile functionality -->
<script src="https://code.createjs.com/soundjs-0.6.2.min.js"></script>
<script type='text/javascript'src="/client/character.js"></script>

<script>
    var WIDTH = 500;
	  var HEIGHT = 500;
    var socket = io(); // socket io
    // var soundID = "Thunder"; //sound

    //signIn/Out
    var signDiv = document.getElementById('signDiv'); //<!-- Sign in Div -->
    var signDivUsername = document.getElementById('signDiv-username'); //<!-- username element -->
    var signDivSignIn = document.getElementById('signDiv-signIn'); //<!-- sign in element -->
    var signDivPassword = document.getElementById('signDiv-password'); //<!-- password element -->

    signDivSignIn.onclick = function(){  //<!-- clicking the sign in button does this function -->
        socket.emit('LogIn',{username:signDivUsername.value,password:signDivPassword.value}); //<!-- emits username + password to server -->
        }

    socket.on('LogInResponse',function(data){  // Sign in Response function
        if(data.success){
            signDiv.style.display = 'none'; //display none until the logging has been passed
            gameDiv.style.display = 'inline-block'; //when log in has been passed then it will display the gameDiv
        }  else
            alert("Sign in was unsuccessful!"); //if password or username is wrong, you get this alart
    });

    //Chat
    var chatText = document.getElementById('chat-text'); //chat text
    var chatInput = document.getElementById('chat-input'); //chat input
    var chatForm = document.getElementById('chat-form'); //the chat form

    socket.on('addToChat',function(data){  //this adds the message to chat
       chatText.innerHTML += '<div>' + data + '</div>';
    });

    socket.on('evalAnswer',function(data){  //evalutation answer
       console.log(data);
    });

    chatForm.onsubmit = function(e) {
        e.preventDefault(); //prevents ""
        if(chatInput.value[0] === '/')
		{
            socket.emit('evalServer',chatInput.value.slice(1)); //to evaluate
		}
        else
            socket.emit('sendMsgToSever',chatInput.value); //this is to send message to sever
        chatInput.value = ''; //resets ""
    }



//game

  // function loadSound () {
  // createjs.Sound.registerSound("assets/thunder.mp3", soundID);
  // }
  //
  // function playSound () {
  // createjs.Sound.play(soundID);
  // }

  var ctx = document.getElementById('ctx').getContext('2d');
  ctx.font = '30px Arial';


  socket.on('newPos', function(data){
    ctx.clearRect(0,0,500,500);
    for(var i = 0; i < data.player.length; i++) //player
        ctx.fillText(data.player[i].number,data.player[i].x,data.player[i].y);


    for(var i = 0; i < data.bullet.length; i++) //bullet
        ctx.fillRect(data.bullet[i].x-5,data.bullet[i].y-5,10,10);
  });



  document.onkeydown = function(event){ //keyboard controls
      if(event.keyCode === 39) //right arrow
          socket.emit('movementKey' ,{inputId:'right',state:true});
      if(event.keyCode === 40) //down arrow
          socket.emit('movementKey' ,{inputId:'down',state:true});
      if(event.keyCode === 37) //left arrow
          socket.emit('movementKey' ,{inputId:'left',state:true});
      if(event.keyCode === 38) //up arrow
          socket.emit('movementKey' ,{inputId:'up',state:true});
  }

  document.onkeyup = function(event){
      if(event.keyCode === 39) //right arrow
          socket.emit('movementKey' ,{inputId:'right',state:false});
      if(event.keyCode === 40) //down arrow
          socket.emit('movementKey' ,{inputId:'down',state:false});
      if(event.keyCode === 37) //left arrow
          socket.emit('movementKey' ,{inputId:'left',state:false});
      if(event.keyCode === 38) //up arrow
          socket.emit('movementKey' ,{inputId:'up',state:false});
   }

   document.onmousedown = function(event){
     socket.emit('movementKey',{inputId:'attack',state:true});
   }
   document.onmouseup = function(event){
     socket.emit('movementKey',{inputId:'attack',state:false});
   }

   document.onmousemove = function(event){
      var x = -250 + event.clientX - 8;  //500 being the whole screen
      var y = -250 + event.clientY - 8;
      var angle = Math.atan2(y,x) / Math.PI * 180;
      socket.emit('movementKey',{inputId:'mouseAngle',state:angle});
   }

  </script>
